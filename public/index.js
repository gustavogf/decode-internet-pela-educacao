firebase.initializeApp({apiKey:"AIzaSyD0qtFjQNMMclAZzEDu4iysSQP5I61uZPs",authDomain:"quero-hackday.firebaseapp.com",projectId:"quero-hackday"});const firestore=firebase.firestore();function recaptchaValidated(){document.getElementById("submitButton").classList.remove("button--disabled"),document.getElementById("submitButton").removeAttribute("disabled")}function closeModal(){document.getElementById("mask").classList.remove("active"),document.body.classList.remove("body-with-modal"),document.getElementById("shareMessage").classList.add("hidden"),document.getElementById("form").classList.remove("hidden"),resetFormData()}function resetFormData(){document.querySelector('input[name="name"]').value="",document.querySelector('input[name="email"]').value="",document.querySelector('input[name="occupation"]').value="",grecaptcha.reset()}function queryPartners(){firestore.collection("assets").where("kind","==","partner").get().then(function(e){mountSupportSection(e)})}function mountSupportSection(e){let t="";e.forEach(function(e){const n=`<a href="${e.data().url}" target="_blank"><img src="${e.data().image_url}" class="partners-image" alt="${e.data().name}"></a>`;t+=n}),document.getElementById("partners").innerHTML=t}function createSigner(){const e=document.querySelector('input[name="name"]').value,t=document.querySelector('input[name="email"]').value,n=document.querySelector('input[name="occupation"]').value,a=(new Date).toLocaleDateString("pt-br",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"});firestore.collection("signatures").add({name:e,email:t,occupation:n,created_at:a}).then(function(){document.getElementById("form").classList.add("hidden"),document.getElementById("shareMessage").classList.remove("hidden"),displaySigners()}).catch(function(e){console.error("Error writing document: ",e)})}function displaySigners(){firestore.collection("signatures").orderBy("created_at").get().then(function(e){let t=0,n=[],a=[],o=[];e.docs.forEach(function(e,t){let n=e.data().email,i=e.data().name;-1===o.indexOf(n)&&(a.push(i),o.push(n))});let i=a.length-2;a.forEach(function(e,a){a===i?(n.push(e),i+=1):t+=1});const c=`${n[1]}, <br>${n[0]}<br> e mais ${t} pessoas j√° assinaram.`;document.getElementById("signersCount").innerHTML=c})}function queryApprovedTestimony(){firestore.collection("testimony").where("approved","==",!0).limit(4).get().then(function(e){let t="";e.forEach(function(e){t+='<div class="testimonials__item card">',t+=`<p class="testimonials__text">"${e.data().testimony}"</p>`,t+=`<span class="testimonials__author">${e.data().name}</span>`,t+="</div>"}),document.getElementById("testimonials").innerHTML=t})}document.getElementById("signButton1").addEventListener("click",function(){document.getElementById("mask").classList.add("active"),document.body.classList.add("body-with-modal")}),document.getElementById("signButton2").addEventListener("click",function(){document.getElementById("mask").classList.add("active"),document.body.classList.add("body-with-modal")}),document.getElementById("close").addEventListener("click",function(){closeModal()}),document.getElementById("mask").addEventListener("click",function(){closeModal()}),document.addEventListener("keyup",e=>{27===e.keyCode&&closeModal()}),queryPartners(),document.addEventListener("submit",e=>{e.preventDefault(),grecaptcha.getResponse().length&&createSigner()}),displaySigners(),queryApprovedTestimony();
